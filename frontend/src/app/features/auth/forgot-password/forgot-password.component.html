<div class="forgot-password-container">
  <div class="forgot-password-wrapper">
    <p-card>
      <ng-template pTemplate="header">
        <div class="forgot-password-header">
          <h2>Forgot Password?</h2>
          <p>Enter your email to receive password reset instructions</p>
        </div>
      </ng-template>

      @if (!submitted) {
        <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()">
          @if (errorMessage) {
            <p-message severity="error" [text]="errorMessage" styleClass="w-full mb-3"></p-message>
          }

          <div class="field">
            <label for="username">Email Address</label>
            <input
              pInputText
              id="username"
              formControlName="username"
              placeholder="Enter your email"
              class="w-full"
              [class.ng-invalid]="username?.invalid && username?.touched"
            />
            @if (username?.invalid && username?.touched) {
              <small class="p-error">
                @if (username?.errors?.['required']) {
                  Email is required
                }
                @if (username?.errors?.['email']) {
                  Please enter a valid email
                }
              </small>
            }
          </div>

          <p-button
            type="submit"
            label="Send Reset Link"
            [loading]="loading"
            styleClass="w-full mb-3"
            [disabled]="loading"
          ></p-button>

          <div class="back-to-login">
            <a routerLink="/auth/login">Back to Login</a>
          </div>
        </form>
      } @else {
        <div class="success-message-container">
          <p-message
            severity="success"
            [text]="successMessage"
            styleClass="w-full mb-3"
          ></p-message>
          <p class="help-text">
            Please check your email inbox (and spam folder) for the password reset link.
          </p>
          <p-button
            label="Back to Login"
            styleClass="w-full"
            routerLink="/auth/login"
          ></p-button>
        </div>
      }

      <ng-template pTemplate="footer">
        <div class="forgot-password-footer">
          <p>&copy; 2024 SkoolCampus. All rights reserved.</p>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
