<div class="reset-password-container">
  <div class="reset-password-wrapper">
    <p-card>
      <ng-template pTemplate="header">
        <div class="reset-password-header">
          <h2>Reset Password</h2>
          <p>Enter your new password</p>
        </div>
      </ng-template>

      @if (!submitted && !errorMessage) {
        <form [formGroup]="resetForm" (ngSubmit)="onSubmit()">
          <div class="field">
            <label for="password">New Password</label>
            <p-password
              formControlName="password"
              placeholder="Enter new password"
              [toggleMask]="true"
              [feedback]="true"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="password?.invalid && password?.touched"
            ></p-password>
            @if (password?.invalid && password?.touched) {
              <small class="p-error">
                @if (password?.errors?.['required']) {
                  Password is required
                }
                @if (password?.errors?.['minlength']) {
                  Password must be at least 4 characters
                }
              </small>
            }
          </div>

          <div class="field">
            <label for="confirmPassword">Confirm Password</label>
            <p-password
              formControlName="confirmPassword"
              placeholder="Confirm new password"
              [toggleMask]="true"
              [feedback]="false"
              styleClass="w-full"
              inputStyleClass="w-full"
              [class.ng-invalid]="confirmPassword?.invalid && confirmPassword?.touched"
            ></p-password>
            @if (confirmPassword?.invalid && confirmPassword?.touched) {
              <small class="p-error">
                @if (confirmPassword?.errors?.['required']) {
                  Confirm password is required
                }
                @if (confirmPassword?.errors?.['minlength']) {
                  Password must be at least 4 characters
                }
              </small>
            }
          </div>

          <p-button
            type="submit"
            label="Reset Password"
            [loading]="loading"
            styleClass="w-full mb-3"
            [disabled]="loading"
          ></p-button>

          <div class="back-to-login">
            <a routerLink="/auth/login">Back to Login</a>
          </div>
        </form>
      } @else if (submitted) {
        <div class="success-message-container">
          <p-message
            severity="success"
            [text]="successMessage"
            styleClass="w-full mb-3"
          ></p-message>
          <p class="help-text">
            Redirecting to login page...
          </p>
          <p-button
            label="Go to Login"
            styleClass="w-full"
            routerLink="/auth/login"
          ></p-button>
        </div>
      } @else {
        <div class="error-message-container">
          <p-message
            severity="error"
            [text]="errorMessage"
            styleClass="w-full mb-3"
          ></p-message>
          <p-button
            label="Back to Login"
            styleClass="w-full"
            routerLink="/auth/login"
          ></p-button>
        </div>
      }

      <ng-template pTemplate="footer">
        <div class="reset-password-footer">
          <p>&copy; 2024 SkoolCampus. All rights reserved.</p>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
